<!DOCTYPE html><!-- DO NOT EDIT THIS FILE-->
<!-- Edit the .stex version instead-->

<html>
<head>
<title>Introduction to stex</title>
<link href="stex.css" rel="stylesheet" type="text/css" />
</head>
<body>




<h1>Introduction to stex</h1>
<h2>R. Kent Dybvig and Oscar Waddell</h2>
<h3>April 2016</h3>


<p>

<table cellpadding=0 cellspacing=0>



<tr><td align="right"><b>1.&nbsp;</b><td><b><a class=plain href="./stex.html#g0">Overview</a></b></td></tr>



<tr><td align="right"><b>2.&nbsp;</b><td><b><a class=plain href="./stex.html#g1">Installation</a></b></td></tr>



<tr><td align="right"><b>3.&nbsp;</b><td><b><a class=plain href="./stex.html#g2">Usage notes</a></b></td></tr>



<tr><td align="right"><b>4.&nbsp;</b><td><b><a class=plain href="./stex.html#g3">Basic stex commands</a></b></td></tr>


<tr><td></td><td><table cellpadding=0 cellspacing=0>
<tr><td><b>4.1.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g4">Inline code</a></b></td></tr>



<tr><td><b>4.2.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g5">Code displays</a></b></td></tr>



<tr><td><b>4.3.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g6">Variables</a></b></td></tr>



<tr><td><b>4.4.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g7">Raw text in code</a></b></td></tr>



<tr><td><b>4.5.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g8">Generated output</a></b></td></tr>



<tr><td><b>4.6.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g9">Verbatim Scheme displays</a></b></td></tr>


</table></td></tr>
<tr><td align="right"><b>5.&nbsp;</b><td><b><a class=plain href="./stex.html#g10">Scheme transcripts</a></b></td></tr>


<tr><td></td><td><table cellpadding=0 cellspacing=0>
<tr><td><b>5.1.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g11">Automatic transcript generation</a></b></td></tr>



<tr><td><b>5.2.&nbsp;</b></td><td><b><a class=plain href="./stex.html#g12">Loading initialization code</a></b></td></tr>


</table></td></tr>
<tr><td align="right"><b>6.&nbsp;</b><td><b><a class=plain href="./stex.html#g13">html-prep support for the <tt>tabular</tt> environment</a></b></td></tr>



<tr><td align="right"><b>7.&nbsp;</b><td><b><a class=plain href="./stex.html#g18">Math in HTML</a></b></td></tr>

  
  
 
</table>


<p>


<p>

<span id="g0"></a>


<h3><span id="./stex:h0"></span>1. Overview</h3>




<p>
The <i>stex</i> package consists of two main programs and some supporting
items, such as make files, make-file templates, class files, and style
files.
The two main programs are <b>scheme-prep</b> and <b>html-prep</b>.
<b>scheme-prep</b> performs a conversion from "stex"-formatted files
into <img src="math/stex/0.gif" alt="<graphic>" />-formatted files, while <b>html-prep</b> converts (some)
<img src="math/stex/0.gif" alt="<graphic>" />-formatted files into html-formatted files.

<p>
An stex file is really just a <img src="math/stex/0.gif" alt="<graphic>" /> file extended with a handful of
commands for including Scheme code (or pretty much any other kind of code,
as long as you don't plan to use the Scheme-specific transcript support)
in a document, plus a couple of additional features rather arbitrarily
thrown in.

<p>
The subset of <img src="math/stex/0.gif" alt="<graphic>" />-formatted files <b>html-prep</b> is capable of
handling is rather small but has nevertheless been useful for our
purposes, which include producing html versions of a couple of books
(<i>The Scheme Programming Language</i>, Editions 2&ndash;4 and the Chez Scheme
User's Guides for Versions 6&ndash;10), the scheme.com web site, class websites,
class assignments, and various other documents.

<p>

<span id="g1"></a>


<h3><span id="./stex:h1"></span>2. Installation</h3>




<p>
A prerequisite to building and using stex is to have Chez Scheme
installed on your system.
You'll also need pdflatex, dvips, ghostscript, and netpbm.
You may also want to have <img src="math/stex/1.gif" alt="<graphic>" /> for use by <b>html-prep</b>:
see "Math in HTML" below.
We've run stex under Linux and OS X but have not tried to run it under
Windows.

<p>
The simplest way to install stex for your personal use is to clone the
stex directory into your home directory, cd into the stex directory,
and run make:

<p>

<p><span style="font-family: monospace;">make&nbsp;Scheme=<i>schemepath</i></span>
<p>where <span style="font-family: monospace;"><i>schemepath</i></span> is the path to the scheme executable.

<p>
This will create a subdirectory, named for the installed Chez Scheme
machine type, containing binary versions of the programs.

<p>
You can also use "make install" to make stex available for other users:

<p>

<p><span style="font-family: monospace;">sudo&nbsp;make&nbsp;install&nbsp;Scheme=<i>schemepath</i>&nbsp;LIB=<i>libdir</i></span>
<p>where <span style="font-family: monospace;"><i>schemepath</i></span> is as described above, and <span style="font-family: monospace;"><i>libdir</i></span> is the
directory where the stex library directory should be installed.
If <span style="font-family: monospace;"><i>libdir</i></span> is writable by the current user, then <span style="font-family: monospace;">sudo</span>
is not necessary.

<p>
As a convenience, you may more succinctly run:

<p>

<p><span style="font-family: monospace;">sudo&nbsp;make&nbsp;install&nbsp;PREFIX=<i>prefixdir</i></span>
<p>where <span style="font-family: monospace;"><i>prefixdir</i></span> specifies in one shot the tree under which
the Scheme executable is installed and
under which the stex library should be installed.
This concise invocation is equivalent to:

<p>

<p><span style="font-family: monospace;">sudo&nbsp;make&nbsp;install&nbsp;Scheme=<i>prefixdir</i>/bin/scheme&nbsp;LIB=<i>prefixdir</i>/lib/stex<i>version</i></span>
<p>where <span style="font-family: monospace;"><i>version</i></span> is the stex version number.

<p>

<span id="g2"></a>


<h3><span id="./stex:h2"></span>3. Usage notes</h3>




<p>
The simplest way to get started with stex is to get this document to
build (in the doc directory) and create your own document by cloning
this document's source file (stex.stex) and make file (Makefile).
If you've installed stex in your home directory, you should be able to
build this document by running "make" without arguments in the doc
directory.
If you've installed stex elsewhere, you'll first have to modify the
include for Mf-stex to reflect its installed location.

<p>
Makefile is where you declare your stex sources and various other things,
like bibtex and graphics files.
If you don't have anything much more complicated than this document,
you might just need to change the line that declares the main stex entry
point, i.e., the line that reads <span style="font-family: monospace;">x&nbsp;=&nbsp;stex</span>, to reflect the name
of your document.

<p>
The make is orchestrated by Mf-stex, which knows how to run
<b>scheme-prep</b>, <b>html-prep</b>, <b>pdflatex</b> (multiple
times), and various other commands to produce both pdf and html versions
of the stex document.

<p>
You can also consult the more elaborate stex source and make files for the
Chez Scheme User's Guide in the csug directory of a Chez Scheme release.

<p>

<span id="g3"></a>


<h3><span id="./stex:h3"></span>4. Basic stex commands</h3>




<p>

<span id="g4"></a>


<h4><span id="./stex:h4"></span>4.1. Inline code</h4>




<p>
An stex document includes inline Scheme (or other) code via the
<span style="font-family: monospace;">\scheme</span> command, e.g.:

<p>
<blockquote>
<pre>
When called with two arguments, \scheme{cons} creates a pair of the two
arguments, e.g., \scheme{(cons 3 4)} produces \scheme{(3 . 4)}.
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>
When called with two arguments, <span style="font-family: monospace;">cons</span> creates a pair of the two
arguments, e.g., <span style="font-family: monospace;">(cons&nbsp;3&nbsp;4)</span> produces <span style="font-family: monospace;">(3&nbsp;.&nbsp;4)</span>.
</blockquote>

<p>

<span id="g5"></a>


<h4><span id="./stex:h5"></span>4.2. Code displays</h4>




<p>
An stex document includes out-of-line Scheme (or other) code via
<span style="font-family: monospace;">\schemedisplay</span> and <span style="font-family: monospace;">\endschemedisplay</span>, e.g.:

<p>
<blockquote>
<pre>
\schemedisplay
(define fact
  (lambda (x)
    "a light year is a measure of distance"))

(define fib
  (lambda (x)
    "a light year is a measure of time"))
\endschemedisplay
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>

<p><span style="font-family: monospace;">(define&nbsp;fact<br />

&nbsp;&nbsp;(lambda&nbsp;(x)<br />

&nbsp;&nbsp;&nbsp;&nbsp;"a&nbsp;light&nbsp;year&nbsp;is&nbsp;a&nbsp;measure&nbsp;of&nbsp;distance"))
<br />
<br />
(define&nbsp;fib<br />

&nbsp;&nbsp;(lambda&nbsp;(x)<br />

&nbsp;&nbsp;&nbsp;&nbsp;"a&nbsp;light&nbsp;year&nbsp;is&nbsp;a&nbsp;measure&nbsp;of&nbsp;time"))</span>
<p></blockquote>

<p>
Within a Scheme display, <span style="font-family: monospace;">;=&gt;</span> is converted into a double right arrow
(<img src="math/stex/2.gif" alt="<graphic>" />), <span style="font-family: monospace;">;-&gt;</span> into a single right arrow (<img src="math/stex/3.gif" alt="<graphic>" />), and
<span style="font-family: monospace;">;==</span> into a phantom of the same size.
This is useful for showing what a piece of code translates or evaluates to,
e.g.:

<p>
<blockquote>
<pre>
A \scheme{let} expression expands into a call to a \scheme{lambda}
expression, e.g.:
\schemedisplay
(let ([a 17]) ;-&gt; ((lambda (a) (+ a a))
  (+ a a))    ;==  17)
\endschemedisplay

A \scheme{let} expression first evaluates the right-hand-side
expression, then evaluates the body in an environment that binds
the left-hand-side variable to the resulting value, e.g.:
\schemedisplay
(let ([a 17]) ;=&gt; 17
  (+ a a))
\endschemedisplay
</pre>


<p>
</blockquote>

<p>
produces

<p>
<blockquote>
A <span style="font-family: monospace;">let</span> expression expands into a call to a <span style="font-family: monospace;">lambda</span>
expression, e.g.:

<p><span style="font-family: monospace;">(let&nbsp;([a&nbsp;17])&nbsp;<img src="math/stex/3.gif" alt="<graphic>" />&nbsp;((lambda&nbsp;(a)&nbsp;(+&nbsp;a&nbsp;a))<br />

&nbsp;&nbsp;(+&nbsp;a&nbsp;a))&nbsp;&nbsp;&nbsp;&nbsp;<img src="gifs/ghostRightarrow.gif">&nbsp;&nbsp;17)</span>
<p>A <span style="font-family: monospace;">let</span> expression first evaluates the right-hand-side
expression, then evaluates the body in an environment that binds
the left-hand-side variable to the resulting value, e.g.:

<p><span style="font-family: monospace;">(let&nbsp;([a&nbsp;17])&nbsp;<img src="math/stex/2.gif" alt="<graphic>" />&nbsp;17<br />

&nbsp;&nbsp;(+&nbsp;a&nbsp;a))</span>
<p></blockquote>

<p>

<span id="g6"></a>


<h4><span id="./stex:h6"></span>4.3. Variables</h4>




<p>
Code can include emphasized variables via the <span style="font-family: monospace;">\var</span> command, e.g.:

<p>
<blockquote>
<pre>
\scheme{(let ([\var{x} \var{e}]) \var{body})} binds the variable \var{x} to
the value of \var{e} in \var{body}.
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>
<span style="font-family: monospace;">(let&nbsp;([<i>x</i>&nbsp;<i>e</i>])&nbsp;<i>body</i>)</span> binds the variable <span style="font-family: monospace;"><i>x</i></span> to
the value of <span style="font-family: monospace;"><i>e</i></span> in <span style="font-family: monospace;"><i>body</i></span>.
</blockquote>

<p>
If the text within a <span style="font-family: monospace;">\var</span> form contains an underscore, the
following character or bracketed subform is converted into a subscript,
e.g., <span style="font-family: monospace;">\var&#123;abc_3&#125;</span>
produces <span style="font-family: monospace;"><i>abc<sub>3</sub></i></span>, and <span style="font-family: monospace;">\var&#123;7e5_16&#125;</span>
produces <span style="font-family: monospace;"><i>7e5<sub>16</sub></i></span>.

<p>
<span style="font-family: monospace;">\var</span> forms may appear within a <span style="font-family: monospace;">\scheme</span> form, within a Scheme display
formed by <span style="font-family: monospace;">\schemedisplay</span> and <span style="font-family: monospace;">\endschemedisplay</span> commands,
or by itself outside of either.

<p>

<span id="g7"></a>


<h4><span id="./stex:h7"></span>4.4. Raw text in code</h4>




<p>
Raw text can be included in code via the <span style="font-family: monospace;">\raw</span> command.
For example:

<p>
<blockquote>
<pre>
\schemedisplay
(sqrt \raw{$x$}) \is \raw{$\sqrt{x}$}.
\endschemedisplay
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>

<p><span style="font-family: monospace;">(sqrt&nbsp;<i>x</i>)&nbsp;<img src="math/stex/2.gif" alt="<graphic>" />&nbsp;<img src="math/stex/4.gif" alt="<graphic>" />.</span>
<p></blockquote>

<p>

<span id="g8"></a>


<h4><span id="./stex:h8"></span>4.5. Generated output</h4>




<p>
Output generated by a Scheme program can be inserted into the output via
<span style="font-family: monospace;">\generated</span> and <span style="font-family: monospace;">\endgenerated</span> commands, e.g.:

<p>
<blockquote>
<pre>
\generated
(let ()
  (define fibs
    (lambda (x y n)
      (if (= n 0)
          '()
          (cons x (fibs y (+ x y) (- n 1))))))
  (let ([n 5])
    (printf "first ~r primes: ~{~s~^, ~}\n" n (fibs 0 1 n))))
\endgenerated
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>
first five primes: 0, 1, 1, 2, 3

<p>
</blockquote>

<p>

<span id="g9"></a>


<h4><span id="./stex:h9"></span>4.6. Verbatim Scheme displays</h4>




<p>
When special features, like <span style="font-family: monospace;">\var</span> forms, need to be
suppressed within a Scheme display, a document can use
<span style="font-family: monospace;">\schemeverbatim</span> and <span style="font-family: monospace;">\endschemeverbatim</span> instead of
<span style="font-family: monospace;">\schemedisplay</span> and <span style="font-family: monospace;">\endschemedisplay</span>.
This document makes extensive use of this feature.

<p>

<span id="g10"></a>


<h3><span id="./stex:h10"></span>5. Scheme transcripts</h3>




<p>

<span id="g11"></a>


<h4><span id="./stex:h11"></span>5.1. Automatic transcript generation</h4>




<p>
The <b>scheme-prep</b> package supports a
<span style="font-family: monospace;">\transcript</span> command for automatically generating Scheme transcripts
from input supplied in the document source.  
All text from the <span style="font-family: monospace;">\transcript</span> marker up to and including the
<span style="font-family: monospace;">\endtranscript</span> marker is replaced with a transcript generated
by supplying the intervening text as the input to a Scheme caf&eacute; (REPL).
If the Scheme transcript needs to contain the sequence
<span style="font-family: monospace;">\endtranscript</span>, a different terminator may be specified as an
optional argument to <span style="font-family: monospace;">\transcript</span>.  
The terminator must be a backslash followed by one or more alphabetic
characters, and is specified without the backslash in the optional argument.

<p>
Three pairs of commands may be redefined to customize the typesetting
of different elements within generated transcripts.  
To modify the typesetting of error messages, redefine <span style="font-family: monospace;">\transerr</span>
and <span style="font-family: monospace;">\endtranserr</span>.  
To modify the typesetting of user input read from the current input port
of the caf&eacute;, redefine <span style="font-family: monospace;">\transin</span> and <span style="font-family: monospace;">\endtransin</span>.
To modify the typesetting of program output written to the current
output port of new caf&eacute;, redefine <span style="font-family: monospace;">\transout</span> and
<span style="font-family: monospace;">\endtransout</span>.

<p>
For example, the following:

<p>
<blockquote>
<pre>
\transcript
(define f
  (lambda (x)       ; indentation and comments are
    (if (zero? x)   ; preserved in the transcript
        1
        (* x (f (- x 1))))))
(values f (f 0) (f 5) (f 20))
(trace f)
(f 4)
\endtranscript
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>

<p><span style="font-family: monospace;">&gt;&nbsp;(define&nbsp;f<br />

&nbsp;&nbsp;&nbsp;&nbsp;(lambda&nbsp;(x)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;indentation&nbsp;and&nbsp;comments&nbsp;are<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(if&nbsp;(zero?&nbsp;x)&nbsp;&nbsp;&nbsp;;&nbsp;preserved&nbsp;in&nbsp;the&nbsp;transcript<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*&nbsp;x&nbsp;(f&nbsp;(-&nbsp;x&nbsp;1))))))<br />

&gt;&nbsp;(values&nbsp;f&nbsp;(f&nbsp;0)&nbsp;(f&nbsp;5)&nbsp;(f&nbsp;20))<br />

#&lt;procedure&nbsp;f&gt;<br />

1<br />

120<br />

2432902008176640000<br />

&gt;&nbsp;(trace&nbsp;f)<br />

(f)<br />

&gt;&nbsp;(f&nbsp;4)<br />

<font color="#0000ff">|(f&nbsp;4)<br />

|&nbsp;(f&nbsp;3)<br />

|&nbsp;|(f&nbsp;2)<br />

|&nbsp;|&nbsp;(f&nbsp;1)<br />

|&nbsp;|&nbsp;|(f&nbsp;0)<br />

|&nbsp;|&nbsp;|1<br />

|&nbsp;|&nbsp;1<br />

|&nbsp;|2<br />

|&nbsp;6<br />

|24<br />

</font>24</span>
<p></blockquote>

<p>
The following example shows how to specify a different transcript
terminator and shows the default formatting imposed by <span style="font-family: monospace;">\transerr</span>,
<span style="font-family: monospace;">\transin</span>, and <span style="font-family: monospace;">\transout</span>.

<p>
<blockquote>
<pre>
\transcript[\stopthistranscript]
#e4.5
(begin (display "Enter a character: ") (read-char))
(begin (display "Enter a character: ") (read-char))Z
(begin (clear-input-port) (display "Enter a character: ") (read-char))
Z
(list (read-char) (read-char) (read-char))abc def
(define silly-repl
  (lambda (prompt)
    (display prompt)
    (let ([x (read)])
      (unless (eof-object? x)
        (let ([result (eval x)])
          (unless (eq? result (void))
            (pretty-print result))
          (silly-repl prompt))))))
(silly-repl "Enter a Scheme expression: ")
(list 1
      2
      3)
(silly-repl "Now what? ")
(define interview
  (lambda ()
    (let* ([fname (begin (display "First name: ") (read))]
           [lname (begin (display "Last name: ") (read))])
      (printf "Hello ~a ~a!~%" fname lname))))
(interview)
john
  doe
#!eof
(printf "good to be back~%")
#!eof
\stopthistranscript
</pre>


<p>
</blockquote>

<p>
produces:

<p>
<blockquote>

<p><span style="font-family: monospace;">&gt;&nbsp;#e4.5<br />

9/2<br />

&gt;&nbsp;(begin&nbsp;(display&nbsp;"Enter&nbsp;a&nbsp;character:&nbsp;")&nbsp;(read-char))<font color="#ff0000"><br />

</font><font color="#0000ff">Enter&nbsp;a&nbsp;character:&nbsp;</font>#\newline<br />

&gt;&nbsp;(begin&nbsp;(display&nbsp;"Enter&nbsp;a&nbsp;character:&nbsp;")&nbsp;(read-char))<font color="#ff0000">Z</font><br />

<font color="#0000ff">Enter&nbsp;a&nbsp;character:&nbsp;</font>#\Z<br />

&gt;&nbsp;(begin&nbsp;(clear-input-port)&nbsp;(display&nbsp;"Enter&nbsp;a&nbsp;character:&nbsp;")&nbsp;(read-char))<br />

<font color="#0000ff">Enter&nbsp;a&nbsp;character:&nbsp;</font><font color="#ff0000">Z</font><br />

#\Z<br />

&gt;&nbsp;(list&nbsp;(read-char)&nbsp;(read-char)&nbsp;(read-char))<font color="#ff0000">abc</font>&nbsp;def<br />

(#\b&nbsp;#\c&nbsp;#\a)<br />

&gt;&nbsp;<br />

Exception:&nbsp;variable&nbsp;def&nbsp;is&nbsp;not&nbsp;bound<br />

Type&nbsp;(debug)&nbsp;to&nbsp;enter&nbsp;the&nbsp;debugger.<br />

&gt;&nbsp;(define&nbsp;silly-repl<br />

&nbsp;&nbsp;&nbsp;&nbsp;(lambda&nbsp;(prompt)<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(display&nbsp;prompt)<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(let&nbsp;([x&nbsp;(read)])<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unless&nbsp;(eof-object?&nbsp;x)<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(let&nbsp;([result&nbsp;(eval&nbsp;x)])<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(unless&nbsp;(eq?&nbsp;result&nbsp;(void))<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pretty-print&nbsp;result))<br />

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(silly-repl&nbsp;prompt))))))<br />

&gt;&nbsp;(silly-repl&nbsp;"Enter&nbsp;a&nbsp;Scheme&nbsp;expression:&nbsp;")<font color="#ff0000"><br />

</font><font color="#0000ff">Enter&nbsp;a&nbsp;Scheme&nbsp;expression:&nbsp;</font><font color="#ff0000">(list&nbsp;1<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3)<br />

</font><font color="#0000ff">(1&nbsp;2&nbsp;3)<br />

Enter&nbsp;a&nbsp;Scheme&nbsp;expression:&nbsp;</font><font color="#ff0000">(silly-repl&nbsp;"Now&nbsp;what?&nbsp;")<br />

</font><font color="#0000ff">Now&nbsp;what?&nbsp;</font><font color="#ff0000">(define&nbsp;interview<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;(lambda&nbsp;()<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;(let*&nbsp;([fname&nbsp;(begin&nbsp;(display&nbsp;"First&nbsp;name:&nbsp;")&nbsp;(read))]<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[lname&nbsp;(begin&nbsp;(display&nbsp;"Last&nbsp;name:&nbsp;")&nbsp;(read))])<br />

</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(printf&nbsp;"Hello&nbsp;~a&nbsp;~a!~%"&nbsp;fname&nbsp;lname))))<br />

</font><font color="#0000ff">Now&nbsp;what?&nbsp;</font><font color="#ff0000">(interview)<br />

</font><font color="#0000ff">First&nbsp;name:&nbsp;</font><font color="#ff0000">john<br />

</font><font color="#0000ff">Last&nbsp;name:&nbsp;</font><font color="#ff0000">&nbsp;&nbsp;doe<br />

</font><font color="#0000ff">Hello&nbsp;john&nbsp;doe!<br />

Now&nbsp;what?&nbsp;</font><font color="#ff0000">#!eof<br />

</font><font color="#0000ff">Enter&nbsp;a&nbsp;Scheme&nbsp;expression:&nbsp;</font><font color="#ff0000">(printf&nbsp;"good&nbsp;to&nbsp;be&nbsp;back~%")<br />

</font><font color="#0000ff">good&nbsp;to&nbsp;be&nbsp;back<br />

Enter&nbsp;a&nbsp;Scheme&nbsp;expression:&nbsp;</font><font color="#ff0000">#!eof</font></span>
<p></blockquote>

<p>
Transcripts do not include a trailing prompt by design.
This is done in such a way that an explicitly displayed string that
happens to look like the prompt is not suppressed.
For example:

<p>
<blockquote>
<pre>
\transcript
(begin (display "&gt; \n") (exit))
\endtranscript
</pre>


<p>
</blockquote>

<p>
should leave the apparent prompt alone since it is generated as program
output.

<p>
<blockquote>

<p><span style="font-family: monospace;">&gt;&nbsp;(begin&nbsp;(display&nbsp;"&gt;&nbsp;\n")&nbsp;(exit))<br />

<font color="#0000ff">&gt;&nbsp;<br />

</font></span>
<p></blockquote>

<p>
Prompt suppression works even with 
changes to <span style="font-family: monospace;">waiter-prompt-string</span>.
For example:

<p>
<blockquote>
<pre>
\transcript
(waiter-prompt-string "antelope? ")
"no thanks"
\endtranscript
</pre>


<p>
</blockquote>

<p>
produces no trailing "antelope? " prompt:

<p>
<blockquote>

<p><span style="font-family: monospace;">&gt;&nbsp;(waiter-prompt-string&nbsp;"antelope?&nbsp;")<br />

antelope?&nbsp;&nbsp;"no&nbsp;thanks"<br />

"no&nbsp;thanks"</span>
<p></blockquote>

<p>

<span id="g12"></a>


<h4><span id="./stex:h12"></span>5.2. Loading initialization code</h4>




<p>
The <span style="font-family: monospace;">stex</span> commands <span style="font-family: monospace;">\schemeinit</span> and <span style="font-family: monospace;">\endschemeinit</span>
are used to bracket Scheme expressions that should be evaluated without
generating a transcript of the results.
This is useful, for example, when writing the description of a programming
assignment.  The solutions can be loaded via <span style="font-family: monospace;">\schemeinit</span> and a
transcript showing how the solutions behave can be generated using the
<span style="font-family: monospace;">\transcript</span> command.

<p>
For example, the following text:

<p>
<blockquote>
<pre>
\schemeinit
(waiter-prompt-string "&gt;")    ; restore the original prompt setting so we
                              ; don't get "antelope?" as the prompt
(define compute-length
  (lambda (x)
    (cond
      [(list? x) (length x)]
      [(vector? x) (vector-length x)]
      [(string? x) (string-length x)]
      [else (errorf 'compute-length "cannot handle ~s" ls)])))
\endschemeinit
\emph{The \scheme{compute-length} procedure behaves as follows:}
\transcript
(compute-length '())
(compute-length '(a b c))
(compute-length "abcd")
(compute-length (vector 1 2 3 4 5 6))
(compute-length compute-length)
\endtranscript
</pre>


<p>
</blockquote>

<p>
produces the output shown below.

<p>
<blockquote>

<p>
<i>The <span style="font-family: monospace;">compute-length</span> procedure behaves as follows:</i>

<p><span style="font-family: monospace;">&gt;&nbsp;(compute-length&nbsp;'())<br />

0<br />

&gt;&nbsp;(compute-length&nbsp;'(a&nbsp;b&nbsp;c))<br />

3<br />

&gt;&nbsp;(compute-length&nbsp;"abcd")<br />

4<br />

&gt;&nbsp;(compute-length&nbsp;(vector&nbsp;1&nbsp;2&nbsp;3&nbsp;4&nbsp;5&nbsp;6))<br />

6<br />

&gt;&nbsp;(compute-length&nbsp;compute-length)
<br />
<br />
Exception&nbsp;in&nbsp;compute-length:&nbsp;cannot&nbsp;handle&nbsp;#&lt;procedure&nbsp;compute-length&gt;<br />

Type&nbsp;(debug)&nbsp;to&nbsp;enter&nbsp;the&nbsp;debugger.</span>
<p></blockquote>

<p>
the last line of input intentionally causes an error, which is
displayed just as it would be displayed in a caf&eacute;.

<p>

<span id="g13"></a>


<h3><span id="./stex:h13"></span>6. html-prep support for the <tt>tabular</tt> environment</h3>




<p>
Support for tables comes with a few caveats:

<p>
<ol>
 <span id="g14"></a><li><span style="font-family: monospace;">@&#123;&#125;</span> directives within <span style="font-family: monospace;">tabular</span>
       column specifiers are flat-out ignored for the time being.
 <span id="g15"></a><li><span style="font-family: monospace;">|</span> directives within <span style="font-family: monospace;">tabular</span>
       column specifiers are essentially ignored.  Their only effect is
       to globally enable borders for the entire HTML table.
 <span id="g16"></a><li><span style="font-family: monospace;">\hrule</span> and <span style="font-family: monospace;">\cline</span> are not yet implemented.
 <span id="g17"></a><li>no warranty is expressed or implied.
</ol>
<p>

<p>
The following code:

<p>
<blockquote>
<pre>
\begin{tabular}{rcl|r}
y &amp;=&amp; f(x) &amp; without loss of generality \\
z &amp; \multicolumn{2}{r}{whee} &amp; this is fun? \\
\multicolumn{4}{c}{
 \begin{tabular}{cc}
   1 &amp; 2 \\
   3 &amp; 4
 \end{tabular}
} \\
a &amp; b &amp; c &amp; d \\
12345 &amp; z &amp; \multicolumn{2}{l}{\scheme{(define~x~"foo")}}
\end{tabular}
</pre>

</blockquote>

<p>
generates this table:

<p>
<blockquote>
<TABLE border="1"><TR><td style="white-space:nowrap; text-align:right;">
y </td><td style="white-space:nowrap; text-align:center;">=</td><td style="white-space:nowrap; text-align:left;"> f(x) </td><td style="white-space:nowrap; text-align:right;"> without loss of generality </td></tr><tr><td style="white-space:nowrap; text-align:right;">
z </td><td style="white-space:nowrap; colspan="2" text-align:right;"> whee </td><td style="white-space:nowrap; text-align:left;"> this is fun? </td></tr><tr><td style="white-space:nowrap; colspan="4" text-align:center;">

 <TABLE><TR><td style="white-space:nowrap; text-align:center;">
   1 </td><td style="white-space:nowrap; text-align:center;"> 2 </td></tr><tr><td style="white-space:nowrap; text-align:center;">
   3 </td><td style="white-space:nowrap; text-align:center;"> 4
 </td></TR></TABLE>
 </td></tr><tr><td style="white-space:nowrap; text-align:right;">
a </td><td style="white-space:nowrap; text-align:center;"> b </td><td style="white-space:nowrap; text-align:left;"> c </td><td style="white-space:nowrap; text-align:right;"> d </td></tr><tr><td style="white-space:nowrap; text-align:right;">
12345 </td><td style="white-space:nowrap; text-align:center;"> z </td><td style="white-space:nowrap; colspan="2" text-align:left;"> <span style="font-family: monospace;">(define&nbsp;x&nbsp;"foo")</span>
</td></TR></TABLE>
</blockquote>

<p>

<span id="g18"></a>


<h3><span id="./stex:h14"></span>7. Math in HTML</h3>




<p>
A few very simple uses of <img src="math/stex/0.gif" alt="<graphic>" />'s math mode can be converted to HTML directly
by <b>html-prep</b>. For typesetting non-trivial math, there are two
strategies available:

<p>
<ol>
  <span id="g19"></a><li>Originally, stex used <img src="math/stex/0.gif" alt="<graphic>" /> to render math to GIF images.
  <span id="g20"></a><li>Optionally, stex can use <a href="???"><img src="math/stex/1.gif" alt="<graphic>" /></a>, which
    generates MathML and/or HTML.
</ol>
<p>

<p>
Using <img src="math/stex/1.gif" alt="<graphic>" /> makes the rendered math accessible to assistive technologies,
CSS, and other browser features. It also tends to look better than math in
GIFs.  However, a few features that stex supports when rendering to GIFs,
notably including the <span style="font-family: monospace;">eqnarray*</span> environment, are not currently
supported when rendering with <img src="math/stex/1.gif" alt="<graphic>" />.

<p>
By default, stex will use <img src="math/stex/1.gif" alt="<graphic>" /> if the "katex" command is found; otherwise,
it will automatically fall back to generating GIFs. To prevent stex from using
<img src="math/stex/1.gif" alt="<graphic>" /> even if it is available, use <span style="font-family: monospace;">make&nbsp;KATEX=</span> or define
<span style="font-family: monospace;">KATEX</span> as empty in your makefile before including Mf-stex. The same
mechanisms can be used to supply a non-default "katex" command or even to
require that <img src="math/stex/1.gif" alt="<graphic>" />be present, e.g.&nbsp; by writing:

<p>
<blockquote>
<pre>
KATEX:=$(if $(shell command -v katex),katex,$(error katex not found))
</pre>

</blockquote>

<p>
The output of <img src="math/stex/1.gif" alt="<graphic>" /> requires supporting CSS and font files. (Notably, it does
not require JavaScript.) By default, stex will attempt to find these relative
to the "katex" command, and it should be able to handle the installation
layouts used by both Node.js and Debian. If they cannot be found automatically,
you will need to define <span style="font-family: monospace;">KATEX_CSS</span>, either at the command line or in
your makefile (before including Mf-stex): likely values include
"./node_modules/katex/dist/katex.css" and
"/usr/share/javascript/katex/katex.css".

<p>

 
 &copy;&nbsp;1998&ndash;2016 R. Kent Dybvig and Oscar Waddell</body>
</html>
